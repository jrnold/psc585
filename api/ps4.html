

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>psc585.ps4 &mdash; PSC 585 Course Code v0.1 documentation</title>
    <link rel="stylesheet" href="../_static/default.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '0.1',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <link rel="top" title="PSC 585 Course Code v0.1 documentation" href="../index.html" />
    <link rel="prev" title="psc585.ps3" href="ps3.html" /> 
  </head>
  <body>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="../np-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="ps3.html" title="psc585.ps3"
             accesskey="P">previous</a> |</li>
        <li><a href="../index.html">PSC 585 Course Code v0.1 documentation</a> &raquo;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <div class="section" id="module-psc585.ps4">
<span id="psc585-ps4"></span><h1>psc585.ps4<a class="headerlink" href="#module-psc585.ps4" title="Permalink to this headline">¶</a></h1>
<p>Problem Set 4 specific code</p>
<dl class="class">
<dt id="psc585.ps4.FinalModel">
<em class="property">class </em><tt class="descclassname">psc585.ps4.</tt><tt class="descname">FinalModel</tt><big>(</big><em>**kwargs</em><big>)</big><a class="reference internal" href="../_modules/psc585/ps4.html#FinalModel"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#psc585.ps4.FinalModel" title="Permalink to this definition">¶</a></dt>
<dd><p class="rubric">Attributes</p>
<table border="1" class="docutils">
<colgroup>
<col width="11%" />
<col width="26%" />
<col width="63%" />
</colgroup>
<tbody valign="top">
<tr><td>delta</td>
<td>float</td>
<td>Discount factor of the government and provinces</td>
</tr>
<tr><td>g1oversigma</td>
<td>float</td>
<td>Parameter <img class="math" src="../_images/math/acb7c92928b1b4fc210bab4f93a3f2149cd1776f.png" alt="\sigma_g"/></td>
</tr>
<tr><td>k</td>
<td>int</td>
<td>Number of provinces</td>
</tr>
<tr><td>m</td>
<td>int</td>
<td>Number of states that provinces can take, <img class="math" src="../_images/math/767b7dc4a8df95a9f8a0faa3bb155e7b49943407.png" alt="2^k"/></td>
</tr>
<tr><td>n</td>
<td>int</td>
<td>Number of states, <img class="math" src="../_images/math/dbcd1ccbcc7c81ed4e01c51eeecc334cf5310457.png" alt="k 2^k"/></td>
</tr>
<tr><td>x</td>
<td>ndarray, shape (k, )</td>
<td>Variable correlated with the wealth generated by each province</td>
</tr>
<tr><td>y</td>
<td>ndarray, shape (k, )</td>
<td>Variable correlated with the cost of war to each province</td>
</tr>
<tr><td>wg</td>
<td>float</td>
<td>Government war cost</td>
</tr>
<tr><td>D</td>
<td>ndarray, shape (k, k)</td>
<td>Matrix of distances between provinces</td>
</tr>
<tr><td>S</td>
<td>ndarray, shape (n, k)</td>
<td>transition matrix</td>
</tr>
<tr><td>data</td>
<td>ndarray, shape (T, k + 2)</td>
<td>Data, as in FinalData.mat. The first column records the state
<img class="math" src="../_images/math/6886dae70698d6f018f7cb966c292fedff02a5d6.png" alt="l, s"/>, enumerated according to the order of the
coordinates. The last column contains the actions of the
government. The <img class="math" src="../_images/math/8c325612684d41304b9751c175df7bcc0f61f64f.png" alt="k"/> middle columns contain the actions
of the provinces.</td>
</tr>
</tbody>
</table>
<p class="rubric">Methods</p>
<dl class="method">
<dt id="psc585.ps4.FinalModel.C_d">
<tt class="descname">C_d</tt><big>(</big><em>Pp</em>, <em>Pg</em><big>)</big><a class="reference internal" href="../_modules/psc585/ps4.html#FinalModel.C_d"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#psc585.ps4.FinalModel.C_d" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute matrix C_d</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field"><th class="field-name">Parameters :</th><td class="field-body"><p class="first"><strong>Pg</strong> : ndarray, shape (n, 2 k)</p>
<blockquote>
<div><p>Conditional choice probabilities for the government</p>
</div></blockquote>
<p><strong>Pp</strong> : ndarray, shape (n, k)</p>
<blockquote>
<div><p>Conditional choice probabilities for provinces</p>
</div></blockquote>
</td>
</tr>
<tr class="field"><th class="field-name">Returns :</th><td class="field-body"><p class="first"><strong>C</strong> : ndarray, shape (n,)</p>
<blockquote class="last">
<div><p>Values of <img class="math" src="../_images/math/47bc1263e44f1b74fd90da02d9e7c26bf4b9edbe.png" alt="C_d"/></p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Notes</p>
<div class="math">
<p><img src="../_images/math/041d870f4e29777fbaa78b1c26ed1ff3765361be.png" alt="C_d(i * T + t, :) = C_i^P(l^t, s^t)" /></p>
</div><p>The matrix <cite>C_d</cite> stacks entries from <cite>C_i^P</cite> by
province and state in the <strong>data</strong> property.</p>
</dd></dl>

<dl class="method">
<dt id="psc585.ps4.FinalModel.Ci">
<tt class="descname">Ci</tt><big>(</big><em>Pp</em>, <em>Pg</em>, <em>i</em><big>)</big><a class="reference internal" href="../_modules/psc585/ps4.html#FinalModel.Ci"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#psc585.ps4.FinalModel.Ci" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute matrix C_i^P</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field"><th class="field-name">Parameters :</th><td class="field-body"><p class="first"><strong>Pg</strong> : ndarray, shape (n, 2 k)</p>
<blockquote>
<div><p>Conditional choice probabilities for the government</p>
</div></blockquote>
<p><strong>Pp</strong> : ndarray, shape (n, k)</p>
<blockquote>
<div><p>Conditional choice probabilities for provinces</p>
</div></blockquote>
<p><strong>i</strong> : int, 1 to k</p>
<blockquote>
<div><p>Province</p>
</div></blockquote>
</td>
</tr>
<tr class="field"><th class="field-name">Returns :</th><td class="field-body"><p class="first"><strong>C</strong> : ndarray, shape (n,)</p>
<blockquote class="last">
<div><p>Values of <img class="math" src="../_images/math/f5fe1713b8cc8aea0345bed1ec6264d78597de76.png" alt="C_i^P"/></p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Notes</p>
<div class="math">
<p><img src="../_images/math/dca35208d02a62311a5a77fd28c4721986fbdcbe.png" alt="C_i^P = \delta (     ilde{P}_i^P(1)  -       ilde{P}_i^P(0))(1 - \delta      ilde{P}^P)^{-1} E_i^P" /></p>
</div></dd></dl>

<dl class="method">
<dt id="psc585.ps4.FinalModel.Ei">
<tt class="descname">Ei</tt><big>(</big><em>Pp</em>, <em>i</em><big>)</big><a class="reference internal" href="../_modules/psc585/ps4.html#FinalModel.Ei"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#psc585.ps4.FinalModel.Ei" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate E_i^P</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field"><th class="field-name">Parameters :</th><td class="field-body"><p class="first"><strong>Pp</strong> : ndarray, shape (n, k)</p>
<blockquote>
<div><p>Conditional choice probabilities for provinces</p>
</div></blockquote>
<p><strong>i</strong> : int, 1 to k</p>
<blockquote>
<div><p>Province</p>
</div></blockquote>
</td>
</tr>
<tr class="field"><th class="field-name">Returns :</th><td class="field-body"><p class="first"><strong>Ei</strong> : ndarray, shape (n, )</p>
<blockquote class="last">
<div><p>Values of <img class="math" src="../_images/math/ccdbf6f1efab2a422d03d5c62461614796734544.png" alt="E_i^P(l, a)"/> in part (b)</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Notes</p>
<div class="math">
<p><img src="../_images/math/435403c11e04347424475f9af3d24ef76b44a8c2.png" alt="E_i^P(l, s) = \sum_{a=0}^1 P_i[a | l, s] E_i^P(a, l, s)" /></p>
</div></dd></dl>

<dl class="method">
<dt id="psc585.ps4.FinalModel.Ei_ai">
<tt class="descname">Ei_ai</tt><big>(</big><em>Pp</em>, <em>i</em>, <em>a</em><big>)</big><a class="reference internal" href="../_modules/psc585/ps4.html#FinalModel.Ei_ai"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#psc585.ps4.FinalModel.Ei_ai" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate E_i^P(a_i)</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field"><th class="field-name">Parameters :</th><td class="field-body"><p class="first"><strong>i</strong> : int, 1 to k</p>
<blockquote>
<div><p>Province</p>
</div></blockquote>
<p><strong>a</strong> : int,</p>
<blockquote>
<div><p>Action. 0 or 1.</p>
</div></blockquote>
</td>
</tr>
<tr class="field"><th class="field-name">Returns :</th><td class="field-body"><p class="first"><strong>Ei</strong> : ndarray, shape (n, )</p>
<blockquote class="last">
<div><p>Values of :math:<a href="#id1"><span class="problematic" id="id2">`</span></a>E_i^P(a_i, l, s) in part (b)</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Notes</p>
<div class="math">
<p><img src="../_images/math/674a6cf18a1583de2f919f04bd7f04c18f405484.png" alt="E_i^P(a_i, l, s) = - \log(P_i[ a_i | l, s])" /></p>
</div></dd></dl>

<dl class="method">
<dt id="psc585.ps4.FinalModel.W_d">
<tt class="descname">W_d</tt><big>(</big><em>Pp</em>, <em>Pg</em><big>)</big><a class="reference internal" href="../_modules/psc585/ps4.html#FinalModel.W_d"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#psc585.ps4.FinalModel.W_d" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate matrix W_d</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field"><th class="field-name">Parameters :</th><td class="field-body"><p class="first"><strong>Pg</strong> : ndarray, shape (n, 2 k)</p>
<blockquote>
<div><p>Conditional choice probabilities for the government</p>
</div></blockquote>
<p><strong>Pp</strong> : ndarray, shape (n, k)</p>
<blockquote>
<div><p>Conditional choice probabilities for provinces</p>
</div></blockquote>
</td>
</tr>
<tr class="field"><th class="field-name">Returns :</th><td class="field-body"><p class="first"><strong>W</strong> : ndarray, shape (n,)</p>
<blockquote class="last">
<div><p>Values of <img class="math" src="../_images/math/cf0bde9133e390571d92953f449b40168eb8cea2.png" alt="W_d"/></p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Notes</p>
<div class="math">
<p><img src="../_images/math/1b6462a9f04ec77b096158748734251e10f43d64.png" alt="W_d(i * T + t, :) = W_i^P(l^t, s^t)" /></p>
</div><p>The matrix <cite>W_d</cite> concatenates rows of <cite>W_i^P</cite> by
province and state in the <strong>data</strong> property.</p>
</dd></dl>

<dl class="method">
<dt id="psc585.ps4.FinalModel.Wi">
<tt class="descname">Wi</tt><big>(</big><em>Pp</em>, <em>Pg</em>, <em>i</em><big>)</big><a class="reference internal" href="../_modules/psc585/ps4.html#FinalModel.Wi"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#psc585.ps4.FinalModel.Wi" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute matrix W_i^P</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field"><th class="field-name">Parameters :</th><td class="field-body"><p class="first"><strong>Pg</strong> : ndarray, shape (n, 2 k)</p>
<blockquote>
<div><p>Conditional choice probabilities for the government</p>
</div></blockquote>
<p><strong>Pp</strong> : ndarray, shape (n, k)</p>
<blockquote>
<div><p>Conditional choice probabilities for provinces</p>
</div></blockquote>
<p><strong>i</strong> : int, 1 to k</p>
<blockquote>
<div><p>Province</p>
</div></blockquote>
</td>
</tr>
<tr class="field"><th class="field-name">Returns :</th><td class="field-body"><p class="first"><strong>W</strong> : ndarray, shape (n, 5)</p>
<blockquote class="last">
<div><p>Values of <img class="math" src="../_images/math/dd107b8f7851edc94a43fbfd18cbf9f05d1056dc.png" alt="W_i^P"/></p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Notes</p>
<div class="math">
<p><img src="../_images/math/1c8a67ff5a9913305e90c617d17c791f1624af23.png" alt="W_i^P = (Z^P_i(1) + \delta ( ilde{P}^P_i(0) -        ilde{P}^P_i(0))(I - \delta      ilde{P}^P)^{-1} - Z^P_i)" /></p>
</div></dd></dl>

<dl class="method">
<dt id="psc585.ps4.FinalModel.Zi">
<tt class="descname">Zi</tt><big>(</big><em>Pg</em>, <em>Pp</em>, <em>i</em><big>)</big><a class="reference internal" href="../_modules/psc585/ps4.html#FinalModel.Zi"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#psc585.ps4.FinalModel.Zi" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate Z_i^P</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field"><th class="field-name">Parameters :</th><td class="field-body"><p class="first"><strong>Pg</strong> : ndarray, shape (n, 2 k)</p>
<blockquote>
<div><p>Conditional choice probabilities for the government</p>
</div></blockquote>
<p><strong>Pp</strong> : ndarray, shape (n, k)</p>
<blockquote>
<div><p>Conditional choice probabilities for provinces</p>
</div></blockquote>
<p><strong>i</strong> : int, 1 to k</p>
<blockquote>
<div><p>Province</p>
</div></blockquote>
</td>
</tr>
<tr class="field"><th class="field-name">Returns :</th><td class="field-body"><p class="first"><strong>Z</strong> : ndarray, shape (n, 5)</p>
<blockquote class="last">
<div><p>Values of <img class="math" src="../_images/math/f25f7f9dbcde0c9a16db0f5673bb2800bf1e0b21.png" alt="Z_i^P"/> from part (b).</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Notes</p>
<div class="math">
<p><img src="../_images/math/6e0c21657b374d3912579e5bf85c770c1343ed1d.png" alt="Z_i^P = \sum_{a=0}^1 P_i[a | l, s] Z_i^P(a, l, s)" /></p>
</div></dd></dl>

<dl class="method">
<dt id="psc585.ps4.FinalModel.Zia">
<tt class="descname">Zia</tt><big>(</big><em>Pg</em>, <em>i</em>, <em>a</em><big>)</big><a class="reference internal" href="../_modules/psc585/ps4.html#FinalModel.Zia"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#psc585.ps4.FinalModel.Zia" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate Z_i^P(a_i)</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field"><th class="field-name">Parameters :</th><td class="field-body"><p class="first"><strong>Pg</strong> : ndarray, shape (n, 2 k)</p>
<blockquote>
<div><p>Conditional choice probabilities for the government</p>
</div></blockquote>
<p><strong>i</strong> : int, 1 to k</p>
<blockquote>
<div><p>Province</p>
</div></blockquote>
<p><strong>a</strong> : int</p>
<blockquote>
<div><p>Action of player <img class="math" src="../_images/math/34857b3ba74ce5cd8607f3ebd23e9015908ada71.png" alt="i"/>. 0 or 1.</p>
</div></blockquote>
</td>
</tr>
<tr class="field"><th class="field-name">Returns :</th><td class="field-body"><p class="first"><strong>Z</strong> : ndarray, shape (n, 5)</p>
<blockquote class="last">
<div><p>Values of <img class="math" src="../_images/math/d65f9048d794ab5fb2386182841bbf64ca2cd11c.png" alt="Z_i^P(a_i, l, s)"/> in part (b)</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Notes</p>
<div class="math">
<p><img src="../_images/math/3634a9420eb4e791af43493af1832ca3e5a72fea.png" alt="Z_i^P(a_i, l, s) = (1, x_i, -(1 - s_i) - P_g(i | l, s), -P_g(i | l, s) y_i)" /></p>
</div><p>if <img class="math" src="../_images/math/f76050d28ae21fcb36c0e2573fcb6afbb52c362a.png" alt="a_i = 1"/> and 0 if <img class="math" src="../_images/math/75a4e1ded2e5e0a480e07eac91c6731cb8cbf116.png" alt="a_i = 0"/>.</p>
</dd></dl>

<dl class="method">
<dt id="psc585.ps4.FinalModel.argmax_theta">
<tt class="descname">argmax_theta</tt><big>(</big><em>Pp</em>, <em>Pg</em><big>)</big><a class="reference internal" href="../_modules/psc585/ps4.html#FinalModel.argmax_theta"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#psc585.ps4.FinalModel.argmax_theta" title="Permalink to this definition">¶</a></dt>
<dd><p>Maximize partial pseudo-likelihood of theta</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field"><th class="field-name">Parameters :</th><td class="field-body"><p class="first"><strong>Pp</strong> : ndarray, shape (n, k)</p>
<blockquote>
<div><p>Conditional choice probabilities for provinces. Initial guess.</p>
</div></blockquote>
<p><strong>Pg</strong> : ndarray, shape (n, 2 k)</p>
<blockquote>
<div><p>Conditional choice probabilities for the government. Initial guess.</p>
</div></blockquote>
</td>
</tr>
<tr class="field"><th class="field-name">Returns :</th><td class="field-body"><p class="first"><strong>theta</strong> : ndarray (5, 1)</p>
<blockquote class="last">
<div><p>Parameter estimates</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Notes</p>
<p>Implements the partial pseudo-likelihood algorithm in part (e) of
the assignment.</p>
</dd></dl>

<dl class="classmethod">
<dt id="psc585.ps4.FinalModel.from_mat">
<em class="property">classmethod </em><tt class="descname">from_mat</tt><big>(</big><em>model</em>, <em>data</em><big>)</big><a class="reference internal" href="../_modules/psc585/ps4.html#FinalModel.from_mat"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#psc585.ps4.FinalModel.from_mat" title="Permalink to this definition">¶</a></dt>
<dd><p>Instantiate class from .mat files</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field"><th class="field-name">Parameters :</th><td class="field-body"><p class="first"><strong>model</strong> : string</p>
<blockquote>
<div><p>Path to FinalModel.dat</p>
</div></blockquote>
<p><strong>data</strong> : string</p>
<blockquote>
<div><p>Path to FinalData.mat</p>
</div></blockquote>
</td>
</tr>
<tr class="field"><th class="field-name">Returns :</th><td class="field-body"><p class="first"><strong>obj</strong> : FinalModel</p>
<blockquote class="last">
<div><p>Instance of the FinalModel class</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="psc585.ps4.FinalModel.model">
<tt class="descname">model</tt><big>(</big><big>)</big><a class="reference internal" href="../_modules/psc585/ps4.html#FinalModel.model"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#psc585.ps4.FinalModel.model" title="Permalink to this definition">¶</a></dt>
<dd><p>Return model dict</p>
</dd></dl>

<dl class="method">
<dt id="psc585.ps4.FinalModel.new_p">
<tt class="descname">new_p</tt><big>(</big><em>Pp</em>, <em>Pg</em>, <em>theta</em><big>)</big><a class="reference internal" href="../_modules/psc585/ps4.html#FinalModel.new_p"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#psc585.ps4.FinalModel.new_p" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate transition probabilities</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field"><th class="field-name">Parameters :</th><td class="field-body"><p class="first"><strong>Pp</strong> : ndarray, shape (n, k)</p>
<blockquote>
<div><p>Conditional choice probabilities for provinces</p>
</div></blockquote>
<p><strong>Pg</strong> : ndarray, shape (n, 2 k)</p>
<blockquote>
<div><p>Conditional choice probabilities for the government</p>
</div></blockquote>
<p><strong>theta</strong> : ndarray, shape (5, )</p>
<blockquote>
<div><p>Parameters</p>
</div></blockquote>
</td>
</tr>
<tr class="field"><th class="field-name">Returns :</th><td class="field-body"><p class="first"><strong>Pp</strong> : ndarray, shape (n, k)</p>
<blockquote>
<div><p>New conditional choice probabilities for provinces</p>
</div></blockquote>
<p><strong>Pg</strong> : ndarray, shape (n, 2 k)</p>
<blockquote class="last">
<div><p>New conditional choice probabilities for the government</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Notes</p>
<p>Takes conditional choice probabilities <img class="math" src="../_images/math/4b4cade9ca8a2c8311fafcf040bc5b15ca507f52.png" alt="P"/> and :math:`    heta`
as an input and returns new conditional choice values.
This is the mapping <img class="math" src="../_images/math/866f0204648be9ca6b10e14dd72295295dd53a79.png" alt="\Psi"/> in part (c) of the assignment.</p>
<p>This is a wrapper for the matlab function <strong>NewP</strong>.</p>
</dd></dl>

<dl class="method">
<dt id="psc585.ps4.FinalModel.npl">
<tt class="descname">npl</tt><big>(</big><em>Pp</em>, <em>Pg</em>, <em>tol=1e-13</em>, <em>maxit=100</em>, <em>verbose=False</em><big>)</big><a class="reference internal" href="../_modules/psc585/ps4.html#FinalModel.npl"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#psc585.ps4.FinalModel.npl" title="Permalink to this definition">¶</a></dt>
<dd><p>Nested-pseudo likelihood Estimator</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field"><th class="field-name">Parameters :</th><td class="field-body"><p class="first"><strong>Pp</strong> : ndarray, shape (n, k)</p>
<blockquote>
<div><p>Conditional choice probabilities for provinces. Initial guess.</p>
</div></blockquote>
<p><strong>Pg</strong> : ndarray, shape (n, 2 k)</p>
<blockquote>
<div><p>Conditional choice probabilities for the government. Initial guess.</p>
</div></blockquote>
<p><strong>tol</strong> : float, optional</p>
<blockquote>
<div><p>Convergence tolerance</p>
</div></blockquote>
<p><strong>maxit</strong> : int, optional</p>
<blockquote>
<div><p>Maximum number of iterations</p>
</div></blockquote>
<p><strong>verbose</strong> : bool, optional</p>
<blockquote>
<div><p>Print iterations</p>
</div></blockquote>
</td>
</tr>
<tr class="field"><th class="field-name">Returns :</th><td class="field-body"><p class="first"><strong>theta</strong> : ndarray, shape (5, 1)</p>
<blockquote>
<div><p>Parameter estimates</p>
</div></blockquote>
<p><strong>converge</strong> : bool</p>
<blockquote>
<div><p>Did the estimates converge?</p>
</div></blockquote>
<p><strong>t</strong> : int</p>
<blockquote>
<div><p>Number of iterations</p>
</div></blockquote>
<p><strong>relres</strong> : float</p>
<blockquote class="last">
<div><p>Relative residual at the end of the iterations</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Notes</p>
<p>Implements part (d) of the assignement.</p>
</dd></dl>

<dl class="method">
<dt id="psc585.ps4.FinalModel.phigprov">
<tt class="descname">phigprov</tt><big>(</big><em>Pp</em>, <em>Pg</em>, <em>theta</em><big>)</big><a class="reference internal" href="../_modules/psc585/ps4.html#FinalModel.phigprov"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#psc585.ps4.FinalModel.phigprov" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate transition probabilities</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field"><th class="field-name">Parameters :</th><td class="field-body"><p class="first"><strong>Pp</strong> : ndarray, shape (n, k)</p>
<blockquote>
<div><p>Conditional choice probabilities for provinces</p>
</div></blockquote>
<p><strong>Pg</strong> : ndarray, shape (n, 2 k)</p>
<blockquote>
<div><p>Conditional choice probabilities for the government</p>
</div></blockquote>
<p><strong>theta</strong> : ndarray, shape (5, )</p>
<blockquote>
<div><p>Parameters</p>
</div></blockquote>
</td>
</tr>
<tr class="field"><th class="field-name">Returns :</th><td class="field-body"><p class="first"><strong>V</strong> : ndarray</p>
<blockquote class="last">
<div><p>Observable state values</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Notes</p>
<p>Takes conditional choice probabilities <img class="math" src="../_images/math/4b4cade9ca8a2c8311fafcf040bc5b15ca507f52.png" alt="P"/> and :math:`    heta`
as an input and returns values <img class="math" src="../_images/math/c546cb9cedfe32018a38f850f1f309feda868376.png" alt="V^P"/>.
This is the mapping <img class="math" src="../_images/math/b85bbfb165b853d6f5f9734be4cdabbb453f4e43.png" alt="\Phi"/> in part (b) of the assignment.</p>
<p>This is a wrapper for the matlab function <strong>Phigprov</strong>.</p>
</dd></dl>

<dl class="method">
<dt id="psc585.ps4.FinalModel.ptilde">
<tt class="descname">ptilde</tt><big>(</big><em>Pp</em>, <em>Pg</em><big>)</big><a class="reference internal" href="../_modules/psc585/ps4.html#FinalModel.ptilde"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#psc585.ps4.FinalModel.ptilde" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate transition probabilities</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field"><th class="field-name">Parameters :</th><td class="field-body"><p class="first"><strong>Pp</strong> : ndarray, shape (n, k)</p>
<blockquote>
<div><p>Conditional choice probabilities for provinces</p>
</div></blockquote>
<p><strong>Pg</strong> : ndarray, shape (n, 2 k)</p>
<blockquote>
<div><p>Conditional choice probabilities for the government</p>
</div></blockquote>
</td>
</tr>
<tr class="field"><th class="field-name">Returns :</th><td class="field-body"><p class="first"><strong>P</strong> : ndarray</p>
<blockquote class="last">
<div><p>Transition probability matrix</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Notes</p>
<p>Takes conditional choice probabilities <img class="math" src="../_images/math/4b4cade9ca8a2c8311fafcf040bc5b15ca507f52.png" alt="P"/> as an input and
returns the transition matrix :math:`   ilde{P}`.</p>
<p>This is a wrapper for the matlab function <strong>Ptilde</strong>.</p>
</dd></dl>

<dl class="method">
<dt id="psc585.ps4.FinalModel.ptilde_i">
<tt class="descname">ptilde_i</tt><big>(</big><em>Pp</em>, <em>Pg</em>, <em>i</em>, <em>ai</em><big>)</big><a class="reference internal" href="../_modules/psc585/ps4.html#FinalModel.ptilde_i"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#psc585.ps4.FinalModel.ptilde_i" title="Permalink to this definition">¶</a></dt>
<dd><p>Transition probabilities conditional on player i&#8217;s action</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field"><th class="field-name">Parameters :</th><td class="field-body"><p class="first"><strong>Pp</strong> : ndarray, shape (n, k)</p>
<blockquote>
<div><p>Conditional choice probabilities for provinces</p>
</div></blockquote>
<p><strong>Pg</strong> : ndarray, shape (n, 2 k)</p>
<blockquote>
<div><p>Conditional choice probabilities for the government</p>
</div></blockquote>
<p><strong>i</strong> : int, 1 to k</p>
<blockquote>
<div><p>Province</p>
</div></blockquote>
<p><strong>ai</strong> : int, bool</p>
<blockquote>
<div><p>Province i&#8217;s action <img class="math" src="../_images/math/412787c048e28774dc63fc27db42dc52ca858de7.png" alt="a_i"/></p>
</div></blockquote>
</td>
</tr>
<tr class="field"><th class="field-name">Returns :</th><td class="field-body"><p class="first"><strong>P</strong> : ndarray</p>
<blockquote class="last">
<div><p>Transition probability matrix</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Notes</p>
<p>This method calculates :math:`  ilde{P}^P_i(a_i)`, the
transition matrix with probabilities :math:`    ilde{p}^P_i(l&#8217;, s&#8217; | l, s, a_i)`.</p>
<p>This is calculated by taking the matrix Pp, and replacing the
columns corresponding to player <img class="math" src="../_images/math/34857b3ba74ce5cd8607f3ebd23e9015908ada71.png" alt="i"/>&#8216;s actions assuming that player <img class="math" src="../_images/math/34857b3ba74ce5cd8607f3ebd23e9015908ada71.png" alt="i"/>
plays action <img class="math" src="../_images/math/412787c048e28774dc63fc27db42dc52ca858de7.png" alt="a_i"/>.  This new probability matrix is then used
as an input to <tt class="xref py py-func docutils literal"><span class="pre">psc585.PS4.FinalModel.ptilde()</span></tt>.</p>
</dd></dl>

<dl class="method">
<dt id="psc585.ps4.FinalModel.y_d">
<tt class="descname">y_d</tt><big>(</big><big>)</big><a class="reference internal" href="../_modules/psc585/ps4.html#FinalModel.y_d"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#psc585.ps4.FinalModel.y_d" title="Permalink to this definition">¶</a></dt>
<dd><p>Data matrix Y_d</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field"><th class="field-name">Returns :</th><td class="field-body"><p class="first"><strong>y</strong> : ndarray, shape (k*T, )</p>
<blockquote class="last">
<div><p>Matrix <img class="math" src="../_images/math/7b51926c244ce37ff266ca6cdefe769a092cf43b.png" alt="Y_d"/></p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Notes</p>
<p>Calculates the <img class="math" src="../_images/math/4b9a84bc8fdb07912e29c6ced50bba64ffc7a174.png" alt="k * T     imes 1"/> matrix <img class="math" src="../_images/math/7b51926c244ce37ff266ca6cdefe769a092cf43b.png" alt="Y_d"/> in part (e) of
the assignment.</p>
</dd></dl>

</dd></dl>

</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
  <h4>Previous topic</h4>
  <p class="topless"><a href="ps3.html"
                        title="previous chapter">psc585.ps3</a></p>
  <h3>This Page</h3>
  <ul class="this-page-menu">
    <li><a href="../_sources/api/ps4.txt"
           rel="nofollow">Show Source</a></li>
  </ul>
<div id="searchbox" style="display: none">
  <h3>Quick search</h3>
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" size="18" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="../np-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="ps3.html" title="psc585.ps3"
             >previous</a> |</li>
        <li><a href="../index.html">PSC 585 Course Code v0.1 documentation</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer">
        &copy; Copyright 2011, Jeffrey B. Arnold.
      Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 1.0.7.
    </div>
  </body>
</html>